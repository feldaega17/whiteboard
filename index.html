<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <title>3D Papan Tulis</title>
    <style>
      body {
        margin: 0;
        font-family: "Segoe UI", Arial, sans-serif;
        background: #f5f6fa;
        color: #2c3e50;
      }
      header {
        background: linear-gradient(135deg, #4a90e2, #0077b6);
        color: white;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }
      header h1 {
        margin: 0;
        font-size: 24px;
      }
      header p {
        margin: 4px 0 0;
        font-size: 14px;
      }
      main {
        display: flex;
        flex-wrap: wrap;
        padding: 20px;
        gap: 20px;
        justify-content: center;
      }
      .card {
        background: white;
        border-radius: 12px;
        padding: 16px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }
      #gl-canvas {
        display: block;
        border-radius: 12px;
        background: #e6e6e6;
      }
      #controls {
        max-width: 300px;
      }
      #controls h3 {
        margin-top: 0;
        font-size: 16px;
        color: #0077b6;
      }
      #controls button {
        background: #0077b6;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 8px 12px;
        margin: 4px 0;
        cursor: pointer;
        transition: 0.2s;
      }
      #controls button:hover {
        background: #005f87;
      }
      #controls input[type="range"] {
        width: 100%;
      }
      #photo-container h3 {
        margin-top: 0;
        font-size: 16px;
        color: #0077b6;
      }
      #photo-container img {
        max-width: 100%;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        margin: 6px 0;
      }
      #texture-image-container img {
        max-width: 50%;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        margin-top: 6px auto;
      }
      .media-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr); /* Membuat 2 kolom */
        gap: 16px; /* Jarak antar video */
      }
      .media-item {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.media-item video {
  width: 100%;
  border-radius: 8px;
  box-shadow: 0 1px 6px rgba(0,0,0,0.15);
}

.caption {
  margin-top: 6px;
  font-size: 0.9rem;
  text-align: center;
  color: #555;
  font-style: italic;
}
#group-info {
        text-align: center;
      }
      #group-info h3 {
        margin-bottom: 10px;
        color: #0077b6;
      }
      #group-info ul {
        list-style: none;
        padding: 0;
        margin: 0;
      }
      #group-info li {
        margin-bottom: 5px;
        font-size: 14px;
      }

      /* Styling untuk Pohon Hierarki */
      #hierarchy-tree {
        text-align: left;
      }
      #hierarchy-tree h3 {
        text-align: center;
      }
      #hierarchy-tree ul {
        list-style-type: none;
        padding-left: 20px;
      }
      #hierarchy-tree li {
        margin: 5px 0;
        padding: 5px;
        border-left: 2px solid #0077b6;
        background-color: #f0f8ff;
      }
      #task-breakdown ul ul {
        padding-left: 20px;
        list-style-type: disc;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Tugas 2: Animasi Objek ITS</h1>
      <p>Implementasi Lighting, Texture, dan Hierarchical Modelling dengan WebGL</p>
    </header>

    <main>
      <div class="card" id="group-info">
        <h3>Anggota Kelompok</h3>
        <ul>
          <li>Felda Ega Fadhila (NRP: 5025231199)</li>
          <li>Naswan Nashir Ramadhan (NRP: 5025231246)</li>
        </ul>
      </div>
      <div class="card">
        <canvas id="gl-canvas" width="700" height="500">
          Browser Anda tidak mendukung HTML5 canvas.
        </canvas>
      </div>

      <div class="card" id="controls">
        <h3>Kontrol Interaksi</h3>
        <button id="reset-button">üîÑ Reset Tampilan</button>
        <button id="board-rotation-toggle">‚ÜîÔ∏è Mode: Putar Semua Objek</button>
        <button id="projection-toggle">üî≠ Mode: Proyeksi Perspektif</button>
        <button id="auto-rotate-toggle">‚ñ∂Ô∏è Mulai Rotasi Otomatis</button>
        <hr />
        <strong>Skala (Dilatasi)</strong><br />
        Horizontal:
        <input
          type="range"
          id="scale-x"
          min="0.5"
          max="2.0"
          step="0.1"
          value="1.0"
        />
        Vertikal:
        <input
          type="range"
          id="scale-y"
          min="0.5"
          max="2.0"
          step="0.1"
          value="1.0"
        />
        <hr />
        <p>
          <b>Tips:</b><br />Gunakan <kbd>WASD</kbd> untuk rotasi<br />
          Gunakan <kbd>Tombol Panah</kbd> untuk menggeser<br />
          <kbd>Scroll</kbd> atau <kbd>+/-</kbd> untuk zoom
        </p>
      </div>

      <div class="card" id="lighting-controls">
        <h3>Kontrol Pencahayaan</h3>
        <button id="auto-light-toggle">‚ñ∂Ô∏è Mulai Gerak Cahaya Otomatis</button>
        <hr />
        <strong>Posisi Cahaya</strong><br />
        X:
        <input
          type="range"
          id="light-x"
          min="-10"
          max="10"
          step="0.5"
          value="1.5"
        /><br />
        Y:
        <input
          type="range"
          id="light-y"
          min="-10"
          max="10"
          step="0.5"
          value="2.0"
        /><br />
        Z:
        <input
          type="range"
          id="light-z"
          min="-10"
          max="10"
          step="0.5"
          value="4.0"
        /><br />
        <hr />
        <strong>Warna Cahaya</strong><br />
        Ambient: <input type="color" id="light-ambient" value="#202020" /><br />
        Diffuse: <input type="color" id="light-diffuse" value="#ffffff" /><br />
        Specular:
        <input type="color" id="light-specular" value="#ffffff" /><br />
        <hr />
        <strong>Material</strong><br />
        Shininess:
        <input
          type="range"
          id="shininess"
          min="1"
          max="200"
          step="1"
          value="100"
        />
        <hr />
        <strong>Warna Frame</strong><br />
        Pilih Warna: <input type="color" id="frame-color" value="#c2c2c2" /><br />
        <button id="frame-rgb-toggle">üåà Mode: Warna Statis</button>
      </div>

      <div class="card" id="texture-controls">
        <h3>Kontrol Tekstur</h3>
        <strong>Pilih Tekstur Papan:</strong><br>
        <select id="texture-select">
          <option value="white">Papan Putih Polos</option>
          <option value="text">Teks "aku ‚ù§Ô∏è grafkom"</option>
          <option value="checkerboard">Papan Catur</option>
          <option value="image">Gambar Simba</option>
        </select>
        <hr>
        <strong>Interaksi Cahaya & Tekstur:</strong><br>
        <select id="texture-mode">
          <option value="0">Modulate (Cahaya * Tekstur)</option>
          <option value="1">Decal (Tekstur Saja)</option>
        </select>
      </div>

      <div class="card" id="animation-controls">
        <h3>Kontrol Animasi</h3>
        <button id="draw-animation-toggle">‚úèÔ∏è Mulai Animasi Menggambar</button>
        <button id="clear-board-button">‚ú® Bersihkan Papan</button>
        <button id="erase-animation-toggle">üßΩ Mulai Animasi Menghapus</button>
        <hr />
        <button id="showcase-animation-toggle">‚ñ∂Ô∏è Mulai Animasi Showcase</button>
      </div>

      <div class="card" id="texture-image-container">
        <h3>Hierarchical Modelling</h3>
        <img src="hierarchical.jpeg" alt="Hierarchical Modelling" />
      </div>

      <div class="card" id="photo-container">
        <h3>Foto Referensi</h3>
        <img src="papan-tulis-depan.jpg" alt="Papan Tulis Depan" />
        <img src="papan-tulis-belakang.jpg" alt="Papan Tulis Belakang" />
      </div>
      
      <div class="card" id="video-container">
      <h3>Video Referensi</h3>
      <div class="media-grid">

        <div class="media-item">
          <video controls>
            <source src="memutar-papan.mp4" type="video/mp4" />
            Browser Anda tidak mendukung video tag.
          </video>
          <p class="caption">Video 1 ‚Äî Memutar Papan.</p>
        </div>

        <div class="media-item">
          <video controls>
            <source src="tulisan-dihapus.mp4" type="video/mp4" />
            Browser Anda tidak mendukung video tag.
          </video>
          <p class="caption">Video 2 ‚Äî Tulisan Dihapus.</p>
        </div>

        <div class="media-item">
          <video controls>
            <source src="menulis.mp4" type="video/mp4" />
            Browser Anda tidak mendukung video tag.
          </video>
          <p class="caption">Video 3 ‚Äî Menulis di Papan.</p>
        </div>

        <div class="media-item">
          <video controls>
            <source src="maju-mundur.mp4" type="video/mp4" />
            Browser Anda tidak mendukung video tag.
          </video>
          <p class="caption">Video 4 ‚Äî Seluruh Papan bisa Bergerak.</p>
        </div>
      </div>

      <div class="card" id="task-breakdown">
        <h3>Pembagian Tugas Proyek</h3>
        <p>Berikut adalah pembagian tugas inti untuk kelompok kami:</p>

        <h4>Felda Ega Fadhila: Pengembang Geometri & Animasi Inti</h4>
        <p>Fokus utama adalah pada mekanika pergerakan objek 3D di dalam scene, termasuk bagaimana objek-objek tersebut bertransformasi dan berinteraksi satu sama lain.</p>
        <ul>
          <li>
            <strong>Pembuatan Objek (Modelling):</strong>
            <ul>
              <li>Membangun semua objek 3D utama (papan, bingkai, rangka penopang, roda, spidol, penghapus, alas).</li>
              <li>Memastikan hierarki objek (misalnya, roda terhubung ke rangka, spidol/penghapus ke papan) berfungsi dengan benar.</li>
            </ul>
          </li>
          <li>
            <strong>Animasi & Pergerakan:</strong>
            <ul>
              <li>Mengimplementasikan logika untuk rotasi global papan tulis dan seluruh scene (menggunakan `rotationAngles` dari input WASD dan mouse drag).</li>
              <li>Mengimplementasikan logika untuk rotasi papan tulis saja (`boardOnlyRotationAngle` dari input WASD dan mouse drag).</li>
              <li>Mengimplementasikan logika untuk translasi/geser papan tulis (`translationOffsets` dari tombol panah).</li>
              <li>Mengimplementasikan logika untuk zoom (zoomFactor dari scroll mouse dan tombol +/-).</li>
              <li>Mengimplementasikan logika untuk rotasi otomatis seluruh scene dan papan tulis (`isAutoRotating`).</li>
            </ul>
          </li>
          <li>
            <strong>Animasi Objek Spesifik:</strong>
            <ul>
              <li>Mengembangkan jalur pergerakan dan transformasi spidol selama animasi menggambar (menentukan `animX`, `animY`, `animZ` spidol, serta rotasi spidol agar ujungnya menunjuk ke papan).</li>
              <li>Mengembangkan jalur pergerakan dan transformasi penghapus selama animasi menghapus.</li>
              <li>Mengimplementasikan mekanika putaran roda (`wheelRotationAngle`) yang disinkronkan dengan pergerakan maju/mundur papan tulis (`translationOffsets.z`).</li>
            </ul>
          </li>
          <li>
            <strong>Orkestrasi Animasi Showcase:</strong>
            <ul>
              <li>Mendefinisikan urutan, waktu, dan jenis pergerakan untuk setiap tahap dalam animasi showcase (`showcaseStage`, `showcaseTime`). Ini termasuk mengkoordinasikan perubahan `rotationAngles`, `translationOffsets`, `boardOnlyRotationAngle`, `wheelRotationAngle`, dan memicu `isDrawingAnimation`/`isErasingAnimation` pada waktu yang tepat.</li>
            </ul>
          </li>
        </ul>

        <h4>Nashwan Nashir Ramadhan: Pengembang Visual & Interaksi UI</h4>
        <p>Fokus utama adalah pada efek visual animasi dan bagaimana pengguna dapat mengontrolnya melalui antarmuka.</p>
        <ul>
          <li>
            <strong>Pencahayaan (Lighting):</strong>
            <ul>
              <li>Mengimplementasikan model pencahayaan (Phong Shading) di shader.</li>
              <li>Mengatur posisi dan properti cahaya (warna ambient, diffuse, specular, shininess).</li>
              <li>Mengimplementasikan kontrol UI untuk semua pengaturan pencahayaan.</li>
            </ul>
          </li>
          <li>
            <strong>Tekstur (Texturing):</strong>
            <ul>
              <li>Mengimplementasikan semua jenis tekstur (polos, teks, catur, gambar) dan penerapannya pada objek.</li>
              <li>Mengimplementasikan Frame Buffer Object (FBO) untuk fitur menggambar dan menghapus di papan tulis.</li>
              <li>Mengimplementasikan kontrol UI untuk pemilihan tekstur dan mode tekstur.</li>
            </ul>
          </li>
          <li>
            <strong>Antarmuka Pengguna (UI) & Kontrol:</strong>
            <ul>
              <li>Merancang dan menyusun `index.html` untuk semua kontrol.</li>
              <li>Mengimplementasikan semua event listeners untuk tombol, slider, dan dropdown yang mengontrol scene (reset, rotasi, proyeksi, skala, visibilitas alas, dll.).</li>
            </ul>
          </li>
          <li>
            <strong>Animasi Efek Visual:</strong>
            <ul>
              <li>Mengimplementasikan logika untuk gerak cahaya otomatis (`isLightAutoMoving`, `lightAnimationTime`), termasuk pembaruan posisi cahaya di UI.</li>
              <li>Mengimplementasikan logika untuk RGB cycling warna frame (`isFrameRgbCycling`, `frameRgbTime`), termasuk pembaruan warna di UI.</li>
              <li>Bertanggung jawab atas implementasi fungsi `drawOnBoard` yang sebenarnya melakukan rendering "tinta" atau "penghapusan" ke Frame Buffer Object (FBO).</li>
            </ul>
          </li>
        </ul>
        </div>
    </main>

    <!-- Shaders -->
    <script id="vertex-shader" type="x-shader/x-vertex">
      #version 300 es
      precision highp float;
      in vec4 aPosition;
      in vec3 aNormal;
      in vec4 aColor; // Warna material dari buffer
      in vec2 aTexCoord; // Koordinat tekstur

      // Matriks
      uniform mat4 uModelViewMatrix;
      uniform mat4 uProjectionMatrix;
      uniform mat3 uNormalMatrix;

      // Properti cahaya
      uniform vec4 uLightPosition;

      // Vektor yang akan diinterpolasi
      out vec3 vNormal;
      out vec3 vLight;
      out vec3 vEye;
      out vec4 vMaterialColor; // Teruskan warna material ke fragment shader
      out vec2 vTexCoord; // Teruskan koordinat tekstur

      void main() {
          vec3 pos = (uModelViewMatrix * aPosition).xyz;

          vec3 light;
          if (uLightPosition.w == 0.0) {
            light = normalize(uLightPosition.xyz);
          } else {
            light = normalize(uLightPosition.xyz - pos);
          }

          vec3 eye = -normalize(pos);
          vec3 normal = normalize(uNormalMatrix * aNormal);

          vNormal = normal;
          vLight = light;
          vEye = eye;
          vMaterialColor = aColor; // Teruskan
          vTexCoord = aTexCoord; // Teruskan

          gl_Position = uProjectionMatrix * uModelViewMatrix * aPosition;
      }
    </script>

    <script id="fragment-shader" type="x-shader/x-fragment">
      #version 300 es
      precision highp float;

      // Data dari vertex shader
      in vec3 vNormal;
      in vec3 vLight;
      in vec3 vEye;
      in vec4 vMaterialColor; // Terima warna material
      in vec2 vTexCoord; // Terima koordinat tekstur

      // Properti cahaya (bukan lagi produk)
      uniform vec4 uLightAmbient;
      uniform vec4 uLightDiffuse;
      uniform vec4 uLightSpecular;
      uniform float uShininess;

      // Sampler untuk tekstur
      uniform sampler2D uSampler;
      uniform sampler2D uDrawingSampler; // Tekstur untuk gambar
      uniform int uTextureMode;

      out vec4 fColor;

      void main() {
          vec3 N = normalize(vNormal);
          vec3 L = normalize(vLight);
          vec3 E = normalize(vEye);
          vec3 H = normalize(L + E);

          // Ambil warna dari tekstur
          vec4 texColor = texture(uSampler, vTexCoord);
          vec4 drawingColor = texture(uDrawingSampler, vTexCoord);

          // Tentukan properti material dari warna yang diterima
          vec4 materialAmbient = vMaterialColor;
          vec4 materialDiffuse;

          if (uTextureMode == 1) { // Decal
              // Gunakan warna tekstur secara langsung
              materialDiffuse = texColor;
          } else { // Modulate (default)
              // Kalikan warna material dengan warna tekstur
              materialDiffuse = vMaterialColor * texColor;
          }

          // Aplikasikan gambar (tinta) di atas hasil sebelumnya.
          materialDiffuse.rgb *= drawingColor.rgb;

          // Biarkan specular material berwarna putih agar bisa memantulkan warna specular cahaya
          vec4 materialSpecular = vec4(1.0, 1.0, 1.0, 1.0);

          // Hitung produk pencahayaan di sini
          vec4 ambient = uLightAmbient * materialAmbient;

          float kd = max(dot(L, N), 0.0);
          vec4 diffuse = kd * uLightDiffuse * materialDiffuse;

          float ks = pow(max(dot(N, H), 0.0), uShininess);
          vec4 specular = ks * uLightSpecular * materialSpecular;

          if (dot(L, N) < 0.0) {
            specular = vec4(0.0, 0.0, 0.0, 1.0);
          }

          fColor = ambient + diffuse + specular;
          fColor.a = 1.0;
      }
    </script>

    <!-- Shaders untuk menggambar ke Framebuffer (FBO) -->
    <script id="fbo-vertex-shader" type="x-shader/x-vertex">
      #version 300 es
      precision highp float;
      in vec2 a_position;
      uniform float u_pointSize;

      void main() {
          gl_Position = vec4(a_position, 0.0, 1.0);
          gl_PointSize = u_pointSize;
      }
    </script>

    <script id="fbo-fragment-shader" type="x-shader/x-fragment">
      #version 300 es
      precision highp float;
      uniform vec4 u_color;
      out vec4 fColor;

      void main() {
          fColor = u_color;
      }
    </script>

    <script src="initShaders.js"></script>
    <script src="MVnew.js"></script>
    <script src="shadedWhiteboard.js"></script>
  </body>
</html>
script>

    <script src="initShaders.js"></script>
    <script src="MVnew.js"></script>
    <script src="shadedWhiteboard.js"></script>
  </body>
</html>
